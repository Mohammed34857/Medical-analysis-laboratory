<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/dashbord.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <title>Dashboard</title>
</head>

<body>
    <div class="menu">
        <ul class="menu-ul">
            <li class="profile">
                <div class="img-box">
                    <img src="photo_2023-04-25_21-34-01.jpg" alt="profile">

                </div>
                <h2>mohammad</h2>
            </li>
            <li>
                <a class="active" href="#">
                    <i class="fas fa-home"></i>
                    <p>dashborde</p>
                </a>
            </li>
            <li onclick="showLaboratory()">
                <a href="#labora" >
                  <button class="btn" > <i class="fas fa-user-group" ></i></button>
                    <p>laboratory</p>
            
                </a>
            </li>
        
            <li onclick="showMaterial()">
                <a href="#materia">
                    <i class="fas fa-table"></i>
                    <p>Materials</p>
                </a>
            </li>
          

            <li>
                <a href="#">
                    <button class="btn"  id="login_bt" onclick="login_but()"><i class="fas fa-cog"></i></button>
                    <p>settings</p>
                </a>
            </li>
            <li class="log-out">
                <a href="laboratory.html">
                    <i class="fas fa-sign-out"></i>
                    <p>log-out</p>
                </a>
            </li>
        </ul>

    </div>

    <div class="content">
        <div id="dash" class="title-info">
            <p>dashborde</p>
            <i class="fas fa-chart-bar"></i>


        </div>

        <div class="data-info" >
            <div class="box">
                <i class="fas fa-user"></i>
                <div class="data">
                    <p>laboratory</p>
                    <span id="num_laboratory"></span>
                </div>

            </div>
          
            <div class="box" >
                <i class="fas fa-table"></i>
                <div class="data">
                    <p>Materials</p>
                    <span id="num_material"></span>
                </div>

            </div>
            <div class="box">
                <i class="fas fa-dollar"></i>
                <div class="data">
                    <p>revenue <br> $ <span id="revenue"></span></p>
                  
                </div>
              </div>
            </div>

            <div id="Amount" class="title-info">
                <p>Amount of Consumption</p>
                <i class="fas fa-table"></i>
            </div>
            
         <table id="amount-Table">
            <thead>
                <tr>
                    <th>name_laboratory</th>
                    <th>name-material</th>
                    <th>amount</th>
                    <th>The-date</th>
               
                   
                </tr>
            </thead>
         </table>

          <div id="labora" class="title-info">
            <p>Laboratory</p>
            <i class="fas fa-table"></i>
        </div>

         <table id="laboratoryTable">
            <thead>
                <tr>
                    <th>name_laboratory</th>
                    <th>name-manager</th>
                    <th>phone</th>
                    <th>Title</th>
                    <th>password</th>
                </tr>
            </thead>
         </table>
    
       <table>
        <thead>
         <tr>
             <th>name_laboratory</th>
             <th>name-manager</th>
             <th>phone</th>
             <th>Title</th>
             <th>password</th>
             <th>edit</th>

         </tr>
        </thead> 
        <tbody>
            <tr>
                <td><input type="text" id="name_laboratory1" class="name_laboratory" ></td>
                <td><input type="text" id="name_manager1" class="name_manager" ></td>
                <td><input type="text" id="phone1" class="phone" ></td>
                <td><input type="text" id="Title1" class="Title" ></td>
                <td><input type="password" id="password1" class="password" > </td>
                <td><i class="fas fa-pen"></i>
                      <button id="add1" class="add">add</button></td>
            </tr>
            <tr>
              <td><input type="text" id="name_laboratory2" class="name_laboratory" ></td>
              <td><input type="text" id="name_manager2" class="name_manager" ></td>
              <td><input type="text" id="phone2" class="phone" ></td>
              <td><input type="text" id="Title2" class="Title" ></td>
              <td><input type="password" id="password2" class="password" > </td>
              <td>
                    <i class="fas fa-pen"></i>
                    <button id="edit1" class="edit">edit</button></td>
          </tr>
          <tr>
              <td><input type="text" id="name_laboratory3" class="name_laboratory" ></td>
              <td><input type="text" id="name_manager3" class="name_manager" ></td>
              <td><input type="text" id="phone3" class="phone" ></td>
              <td><input type="text" id="Title3" class="Title" ></td>
              <td><input type="password" id="password3" class="password" > </td>
              <td>
                    <i class="fas fa-trash"></i>
                    <button id="delete1" class="delete">delete</button></td>
          </tr>
          
        </tbody>
     </table>

        <div id="materia" class="title-info">
            <p>Materials</p>
            <i class="fas fa-table"></i>
        </div>

        <table id="materialsTable">

           <thead >
            <tr>
                <th>product</th>
                <th>Production_Date</th>
                <th>Production_Date</th>
                <th>price</th>
                <th>count</th>
                <th>price-offer</th>
               
            </tr>
        </thead> 
        </table>

        <table >

            <thead >
             <tr>
                 <th>product</th>
                 <th>Production_Date</th>
                 <th>Production_Date</th>
                 <th>price</th>
                 <th>count</th>
                 <th>price-offer</th>
                 <th>edit</th>
 
             </tr>
         </thead> 
         <tbody>
          <tr>
              <td><input type="text" id="product1" class="product" ></td>
              <td><input type="text" id="Production_Date1" class="Production_Date" ></td>
              <td><input type="text" id="Expiry_date1" class="Expiry_date" ></td>
              <td><input type="text" id="price1" class="price" ></td>
              <td><input type="text" id="Quantity1" class="Quantity" > </td>
              <td><input type="text" id="price-offer1" class="price-offer" > </td>
              <td><i class="fas fa-pen"></i>
                    <button id="add" class="add">add</button>
          </tr>
          <tr>
            <td><input type="text" id="product2" class="product" ></td>
            <td><input type="text" id="Production_Date2" class="Production_Date" ></td>
            <td><input type="text" id="Expiry_date2" class="Expiry_date" ></td>
            <td><input type="text" id="price2" class="price" ></td>
            <td><input type="text" id="Quantity2" class="Quantity" > </td>
            <td><input type="text" id="price-offer2" class="price-offer" > </td>
            <td>
                  <i class="fas fa-pen"></i>
                  <button id="edit" class="edit">edit</button>
        </tr>
        <tr>
            <td><input type="text" id="product3" class="product" ></td>
            <td><input type="text" id="Production_Date3" class="Production_Date" ></td>
            <td><input type="text" id="Expiry_date3" class="Expiry_date" ></td>
            <td><input type="text" id="price3" class="price" ></td>
            <td><input type="text" id="Quantity3" class="Quantity" > </td>
            <td><input type="text" id="price-offer3" class="price-offer" > </td>
            <td>
                  <i class="fas fa-trash"></i>
                  <button id="delete" class="delete">delete</button></td>
        </tr>
          </tbody>
         </table>


     <div id="loginWindow" class="login">            
        <div class="login_form">
            <button id="close_bt"><i class="fa-solid fa-close" style="color: #00ccff;"></i></button>
        <h2 id="loginText">تعديل معلومات الحساب </h2>
        <form action method="post">
        <div class="input_group"><i class="fa-solid fa-user" style="color: #00ccff;"></i>
            <input 
            type="text"
            placeholder="الاسم القديم"
            class="input_text"
            autocomplete="off"
            id="oldusername"
            >
        
        </div>
        <div class="input_group"><i class="fa-solid fa-user" style="color: #00ccff;"></i>
            <input 
            type="text"
            placeholder="الاسم الجديد"
            class="input_text"
            autocomplete="off"
            id="newusername"
            >
            </div>
        <div class="input_group"><i class="fa-solid fa-unlock" style="color: #00ccff;"></i>
            <input 
            type="password"
            placeholder="  كلمة المرور القديمة  "
            class="input_text"
            autocomplete="off"
            id="oldpassword"
            >
        </div>
        <div class="input_group"><i class="fa-solid fa-unlock" style="color: #00ccff;"></i>
            <input 
            type="password"
            placeholder="كلمة المرور الجديدة  "
            class="input_text"
            autocomplete="off"
            id="newpassword"
            >
        </div>
        <button class="button_group" id="login_butt" type="button" onclick="updateManager()">تعديل</button>
     
       </form>
    </div>

              </div>





              
    <script>
        
         let login_but = function () {
        var loginButton = document.getElementById("login_bt");
        var loginWindow = document.getElementById("loginWindow");
        var loginWindowClose = document.getElementById("close_bt");
           loginButton.addEventListener("click", function() {
           loginWindow.style.visibility = "visible"; 
          });
        loginWindowClose.addEventListener("click", function() {
        loginWindow.style.visibility = "hidden"; 
        });
        const oldusername = document.getElementById('oldusername');
        const oldpassword = document.getElementById('oldpassword');
        fetch("https://testbyad.adaptable.app/employee/64dfdb227ce27c25a24a968d")
        .then(response => response.json())
        .then(data =>{
            oldusername.value = data.name;
            oldpassword.value = data.password;
        })
    }

    function updateManager(){
        const newusername = document.getElementById('newusername').value;
        const newpassword = document.getElementById('newpassword').value;
        fetch(`https://testbyad.adaptable.app/employee/64dfdb227ce27c25a24a968d`,{
                 method: 'PATCH',
                    body: JSON.stringify({
                        name: newusername,
                        password: newpassword
                    }),
                    headers: {
                        'Content-type': 'application/json; charset=UTF-8'
                    }
                })
                .then((response) => response.json())
                .then((json) => console.log(json));
                setTimeout(() => {
                    window.location.reload();
                }, 2000);
            }
    
    

    window.onload = function() {

   const number_material = document.getElementById('num_material');     
   const number_laboratory = document.getElementById('num_laboratory');
   const num_revenue = document.getElementById('revenue');
   

   var number_revenue = null;
   fetch('https://testbyad.adaptable.app/order')
        .then(response => response.json())
        .then(data =>{
         data.forEach(reven => {
        number_revenue+= reven.price * 0.1 ;
       })
      num_revenue.textContent =  number_revenue ;
   })
   fetch('https://testbyad.adaptable.app/laboratory') 
            .then(response => response.json())
             .then(data => {
                var num_laboratory = null;
                data.forEach(laboratory => {
                num_laboratory++;
              });
              number_laboratory.textContent = num_laboratory;
             })
   fetch('https://testbyad.adaptable.app/material') 
         .then(response => response.json())
         .then(data => {
            var num_material = null;
            data.forEach(material => {
            num_material++;
         });
        number_material.textContent = num_material;
        })          
    }

        function showLaboratory(){
        
         var table2 = document.getElementById('laboratoryTable');
            fetch('https://testbyad.adaptable.app/laboratory') 
            .then(response => response.json())
             .then(data => {
         data.forEach(laboratory => {
         var row = table2.insertRow(-1);

         var name_laboratoryCell = row.insertCell(0);
         name_laboratoryCell.innerHTML = `<td> <span class="namelaboratory"> ${laboratory.name_laboratory}</span></td>`;

         var name_managerCell = row.insertCell(1);
         name_managerCell.innerHTML = `<td> <span class="namemanager"> ${laboratory.name_manager}</span></td>`;

         var phoneCell = row.insertCell(2);
         phoneCell.innerHTML = `<td> <span class="phon"> ${laboratory.number_phon}</span></td>`;

         var TitleCell = row.insertCell(3);
         TitleCell.innerHTML = `<td> <span class="Tit"> ${laboratory.address}</span></td>`;

         var passwordcall = row.insertCell(4);
         passwordcall.innerHTML = `<td> <span class="pass"> ${laboratory.password}</span></td>`;

          });
         })
        }   
      


         function showMaterial(){
            var table1 = document.getElementById('materialsTable');
          fetch('https://testbyad.adaptable.app/material') 
         .then(response => response.json())
         .then(data => {
        data.forEach(material => {
        
        var row = table1.insertRow(-1);
        var productCell = row.insertCell(0);
        productCell.innerHTML = `<td> <span class="product"> ${material.name_Material}</span></td>`;

        var Production_DateCell = row.insertCell(1);
        Production_DateCell.innerHTML = `<td> <span class="Production_Date"> ${material.Production_Date}</span></td>`;

        var Expiry_dateCell = row.insertCell(2);
        Expiry_dateCell.innerHTML = `<td> <span class="Expiry_date"> ${material.Expiry_date}</span></td>`;

        var priceCell = row.insertCell(3);
        priceCell.innerHTML = `<td> <span class="price"> ${material.price}</span></td>`;

        var Quantitycall = row.insertCell(4);
        Quantitycall.innerHTML = `<td> <span class="count"> ${material.Quantity}</span></td>`;

        var price_offercall = row.insertCell(5);
        price_offercall.innerHTML = `<td> <span class="count"> ${material.price_offer}</span></td>`;

         });
        })         
    }

    document.getElementById("add1").addEventListener("click", function (event) {
                event.preventDefault();
                const name_labor = document.getElementById("name_laboratory1").value;
                const name_mana = document.getElementById("name_manager1").value;
                const phone = document.getElementById("phone1").value;
                const Title = document.getElementById("Title1").value;
                const pass = document.getElementById("password1").value;
                
                const newLaboratory = {
                    name_laboratory: name_labor,
                    name_manager: name_mana,
                    number_phon: phone,
                    address_details: Title,
                    password: pass
                    };

                    fetch("https://testbyad.adaptable.app/laboratory", {
                        method: 'POST',
                        body: JSON.stringify(newLaboratory),
                        headers: {
                            'Content-type': 'application/json; charset=UTF-8'
                        }
                       }) 
                        .then(response => response.json())
                        .then(json => {
                            setTimeout(() => {
                                window.location.reload();
                            }, 2000);
                        })
                        .catch(error => {
                            console.error('حدث خطأ أثناء الطلب:', error);
                        });
         });



         document.getElementById("edit1").addEventListener("click", function (event) {
                event.preventDefault();
                const name_labor = document.getElementById("name_laboratory2").value;
                const name_mana = document.getElementById("name_manager2").value;
                const phone = document.getElementById("phone2").value;
                const Title = document.getElementById("Title2").value;
                const pass = document.getElementById("password2").value;
                fetch("https://testbyad.adaptable.app/laboratory") 
                .then(response => response.json())
                .then(data => {
                var id_laboratory= null;
               for (var i = 0; i < data.length; i++) {
                 if (data[i].name_laboratory=== name_labor ) {
                    id_laboratory= data[i]._id;
                    break;
                }
               }
                fetch(`https://testbyad.adaptable.app/laboratory/${id_laboratory}`, {
                    method: 'PATCH',
                    body: JSON.stringify({
                        name_laboratory: name_labor,
                        name_manager: name_mana,
                        number_phon: phone,
                        address_details: Title,
                         password: pass
                    }),
                    headers: {
                        'Content-type': 'application/json; charset=UTF-8'
                    }
                })
             })
                    .then((response) => response.json())
                    .then((json) => console.log(json));
                   setTimeout(() => {
                    window.location.reload();
                }, 2000);
            });



         document.getElementById("delete1").addEventListener("click", function (event) {
                event.preventDefault();
                const name_labor3 = document.getElementById("name_laboratory3").value;
             fetch("https://testbyad.adaptable.app/laboratory") 
                .then(response => response.json())
                .then(data => {
                    var id_laboratory3= null;
               for (var i = 0; i < data.length; i++) {
                 if (data[i].name_laboratory=== name_labor3) {
                    id_laboratory3= data[i]._id;
                    break;
                }
               }
                fetch(`https://testbyad.adaptable.app/laboratory/${id_laboratory3}`, {
                    method: 'DELETE',
                    body: JSON.stringify({
                        
                    }),
                    headers: {
                        'Content-type': 'application/json; charset=UTF-8'
                    }
                })
                    .then((response) => response.json())
                    .then((json) => console.log(json));
                   setTimeout(() => {
                    window.location.reload();
                   }, 2000);
            })
            });


         document.getElementById("add").addEventListener("click", function (event) {
                event.preventDefault();
                const material = document.getElementById("product1").value;
                const Production = document.getElementById("Production_Date1").value;
                const Expiry = document.getElementById("Expiry_date1").value;
                const price = document.getElementById("price1").value;
                const Quant = document.getElementById("Quantity1").value;
                const priceOffer1 = document.getElementById("price-offer1").value;

                const newMaterial = {
                    name_Material: material,
                    Production_Date: Production,
                    Expiry_date: Expiry,
                    Quantity: Quant,
                    price: price,
                    price_offer:priceOffer1
                    };

                    fetch("https://testbyad.adaptable.app/material", {
                        method: 'POST',
                        body: JSON.stringify(newMaterial),
                        headers: {
                            'Content-type': 'application/json; charset=UTF-8'
                        }
                       }) 
                        .then(response => response.json())
                        .then(json => {
                            setTimeout(() => {
                                window.location.reload();
                            }, 2000);
                        })
                        .catch(error => {
                            console.error('حدث خطأ أثناء الطلب:', error);
                        });
         });

         

         document.getElementById("edit").addEventListener("click", function (event) {
                event.preventDefault();
                const material2 = document.getElementById("product2").value;
                const Production2 = document.getElementById("Production_Date2").value;
                const Expiry2 = document.getElementById("Expiry_date2").value;
                const price2 = document.getElementById("price2").value;
                const Quant2 = document.getElementById("Quantity2").value;
                const priceOffer2 = document.getElementById("price-offer2").value;
                fetch("https://testbyad.adaptable.app/material") 
                .then(response => response.json())
                .then(data => {
                var id_product2= null;
               for (var i = 0; i < data.length; i++) {
                 if (data[i].name_Material=== material2 ) {
                    id_product2= data[i]._id;
                    break;
                }
               }
                fetch(`https://testbyad.adaptable.app/material/${id_product2}`, {
                    method: 'PATCH',
                    body: JSON.stringify({
                         name_Material: material2,
                         Production_Date: Production2,
                         Expiry_date: Expiry2,
                         Quantity: Quant2,
                         price: price2,
                         price_offer:priceOffer2
                    }),
                    headers: {
                        'Content-type': 'application/json; charset=UTF-8'
                    }
                })
             })
                    .then((response) => response.json())
                    .then((json) => console.log(json));
                   setTimeout(() => {
                    window.location.reload();
                }, 2000);
            });



         document.getElementById("delete").addEventListener("click", function (event) {
                event.preventDefault();
                const prod3 = document.getElementById("product3").value;
             fetch('https://testbyad.adaptable.app/material') 
                .then(response => response.json())
                .then(data => {
                var id_product3= null;
               for (var i = 0; i < data.length; i++) {
                 if (data[i].name_Material=== prod3 ) {
                    id_product3= data[i]._id;
                    break;
                }
               }
                fetch(`https://testbyad.adaptable.app/material/${id_product3}`, {
                    method: 'DELETE',
                    body: JSON.stringify({
                        
                    }),
                    headers: {
                        'Content-type': 'application/json; charset=UTF-8'
                    }
                })
                    .then((response) => response.json())
                    .then((json) => console.log(json));
                   setTimeout(() => {
                    window.location.reload();
                   }, 2000);
            })
            });

    </script>

</body>

</html>